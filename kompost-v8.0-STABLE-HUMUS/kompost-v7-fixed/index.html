<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Das Kompostwesen</title>
    <link rel="stylesheet" href="css/layers.css">
    <link rel="stylesheet" href="css/mobile.css">
</head>
<body>
    <!-- LAYER 0: KOMPOST A + SCHWARZE KUGEL -->
    <div id="layer0" class="layer active">
        <div class="compost-start" id="compost-start">
            <img src="images/kompost_a.jpg" alt="Komposthaufen" class="compost-photo">
            
            <!-- Schwarze Kugel (erscheint nach erstem Click) -->
            <div class="black-orb hidden" id="black-orb">
                <div class="orb-inner"></div>
            </div>
            
            <!-- Buchcover (erscheint nach Kugel-Click) -->
            <div class="book-reveal hidden" id="book-reveal">
                <img src="images/buchcover_real.jpg" alt="Buchcover" class="book-cover-reveal">
            </div>
        </div>
    </div>

    <!-- LAYER 1: BUCH LESEN (Inhaltsverzeichnis + Kapitel) -->
    <div id="layer1" class="layer">
        <!-- Kompost B Hintergrund -->
        <div class="compost-background" id="compost-bg-1">
            <img src="images/kompost_b.jpg" alt="Kompost">
        </div>
        
        <!-- Navigation (nur weiter, kein zur√ºck) -->
        <button class="btn-nav btn-forward" onclick="switchLayer(2)">‚Üí</button>
        
        <!-- Buch-Fenster -->
        <div class="book-window">
            <div class="book-header">
                <h1 id="book-title">Die fr√∂hliche Abschaffung von Ostdeutschland</h1>
                <p class="book-subtitle">Gesammelte Werke</p>
            </div>
            
            <!-- Inhaltsverzeichnis -->
            <div class="table-of-contents" id="toc">
                <h2>Inhaltsverzeichnis</h2>
                <div id="toc-list"></div>
            </div>
            
            <!-- Lese-Ansicht -->
            <div class="reading-view hidden" id="reading-view">
                <div class="chapter-header">
                    <button class="nav-btn" id="prev-chapter">‚Üê Vorheriges</button>
                    <h2 id="chapter-title"></h2>
                    <button class="nav-btn" id="next-chapter">N√§chstes ‚Üí</button>
                </div>
                
                <div class="chapter-content" id="chapter-content"></div>
                
                <div class="chapter-footer">
                    <button class="btn-secondary" id="back-to-toc">‚Üê Zur√ºck zum Inhaltsverzeichnis</button>
                    <div class="chapter-meta" id="chapter-meta"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- LAYER 2: BIOLOGISCHE KOMPOSTIERUNG -->
    <div id="layer2" class="layer">
        <div class="compost-background-darker compost-clickable" id="compost-bg-2" data-next-layer="3">
            <img src="images/kompost_b.jpg" alt="Kompost" style="opacity: 0.15; filter: blur(1px);">
        </div>
        
        <!-- Navigation -->
        <button class="btn-nav btn-back" onclick="switchLayer(1)">‚Üê</button>
        <button class="btn-nav btn-forward" onclick="switchLayer(3)">‚Üí</button>
        
        <div class="split-container">
            <!-- Links: Original-Textk√∂rper (w√§hlbar) -->
            <div class="split-left">
                <h3>üìñ Textk√∂rper</h3>
                <select id="corpus-select" class="corpus-dropdown">
                    <option value="full">Ganzer Textk√∂rper (84 Kapitel)</option>
                    <option value="part1">Nur Teil I: Schlaflosigkeitsrevolver</option>
                    <option value="part2">Nur Teil II: Blumen & L√∂cher</option>
                    <option value="part3">Nur Teil III: Die Abschaffung von Erfurt</option>
                </select>
                <div class="text-display" id="original-text">
                    <p class="hint">W√§hle Textk√∂rper oben...</p>
                </div>
            </div>
            
            <!-- Mitte: Biologische Parameter -->
            <div class="split-middle">
                <h3>üî¨ Bio-Parameter</h3>
                
                <!-- Temperatur -->
                <div class="param-control">
                    <label>
                        üå°Ô∏è Temperatur
                        <span class="param-value" id="temp-value">45¬∞C</span>
                    </label>
                    <input type="range" id="temperature" min="0" max="100" value="45" step="1">
                    <div class="param-hint">
                        <span class="cold">0-25¬∞C Kalt</span>
                        <span class="warm">25-45¬∞C Mesophil</span>
                        <span class="hot">45-70¬∞C Thermophil</span>
                        <span class="extreme">70-100¬∞C Extrem</span>
                    </div>
                </div>
                
                <!-- Feuchtigkeit -->
                <div class="param-control">
                    <label>
                        üíß Feuchtigkeit
                        <span class="param-value" id="moisture-value">50%</span>
                    </label>
                    <input type="range" id="moisture" min="0" max="80" value="50" step="5">
                    <div class="param-hint">
                        <span>0-40% Trocken</span>
                        <span>40-60% Optimal</span>
                        <span>60-80% Nass</span>
                    </div>
                </div>
                
                <!-- pH-Wert -->
                <div class="param-control">
                    <label>
                        üß™ pH-Wert
                        <span class="param-value" id="ph-value">7.0</span>
                    </label>
                    <input type="range" id="ph" min="4" max="10" value="7" step="0.5">
                    <div class="param-hint">
                        <span>4-6 Sauer</span>
                        <span>6-8 Neutral</span>
                        <span>8-10 Basisch</span>
                    </div>
                </div>
                
                <!-- Bel√ºftung -->
                <div class="param-control">
                    <label>üå¨Ô∏è Bel√ºftung</label>
                    <select id="aeration">
                        <option value="aerob">Aerob (lesbar)</option>
                        <option value="anaerob">Anaerob (surreal)</option>
                    </select>
                </div>
                
                <!-- Enzym -->
                <div class="param-control">
                    <label>üß¨ Enzym-Essenz</label>
                    <select id="enzyme-select">
                        <option value="">Alle</option>
                        <option value="#Dividual">#Dividual</option>
                        <option value="#Lysis">#Lysis</option>
                        <option value="#Myzel">#Myzel</option>
                        <option value="#Noise">#Noise</option>
                        <option value="#Resonanz">#Resonanz</option>
                    </select>
                </div>
                
                <!-- Zone -->
                <div class="param-control">
                    <label>üåç Zonen-Tiefe</label>
                    <select id="zone-select">
                        <option value="">Alle Zonen</option>
                        <option value="I">Zone I (Biographisch)</option>
                        <option value="II">Zone II (Mittel)</option>
                        <option value="III">Zone III (Maximal zersetzt)</option>
                    </select>
                </div>
                
                <!-- Text-L√§nge -->
                <div class="param-control">
                    <label>
                        üìè Text-L√§nge
                    </label>
                    <input type="range" id="text-length" min="1" max="2000" value="500" step="1">
                </div>
                
                <!-- C:N-Verh√§ltnis (Fragmentierung) -->
                <div class="param-control">
                    <label>
                        üîÑ C:N-Verh√§ltnis
                        <span class="param-value" id="cn-value">30:1</span>
                    </label>
                    <input type="range" id="cn-ratio" min="10" max="50" value="30" step="5">
                    <div class="param-hint">
                        <span>10 N-reich (zusammenh√§ngend)</span>
                        <span>30 Optimal</span>
                        <span>50 C-reich (fragmentiert)</span>
                    </div>
                </div>
                
                <button class="btn-generate" id="btn-generate">
                    üå± KOMPOSTIEREN
                </button>
                
                <button class="btn-humus" id="btn-to-humus" style="margin-top: 10px;">
                    ‚Üíüíö HUMUS SPEICHERN
                </button>
                
                <div class="humus-status" id="humus-status">
                    Humus: <span id="humus-count">0</span> / 20
                </div>
            </div>
            
            <!-- Rechts: Generierter Output -->
            <div class="split-right">
                <h3>üî¨ Generiert</h3>
                <div class="text-display" id="generated-text">
                    <p class="hint">Klicke GENERIEREN um zu beginnen...</p>
                </div>
            </div>
        </div>
    </div>

    <!-- LAYER 3: KI-FERMENTIERUNG -->
    <div id="layer3" class="layer">
        <div class="compost-background-darkest compost-clickable" id="compost-bg-3" data-next-layer="4">
            <img src="images/kompost_b.jpg" alt="Kompost" style="opacity: 0.05; filter: blur(3px);">
            <div class="glitch-overlay"></div>
        </div>
        
        <!-- Navigation -->
        <button class="btn-nav btn-back" onclick="switchLayer(2)">‚Üê</button>
        <button class="btn-nav btn-forward" onclick="switchLayer(4)">‚Üí</button>
        
        <div class="ki-container">
            <!-- INPUT BOX (verschwindet nach Transformation) -->
            <div id="ki-input-box" class="ki-box floating-blue">
                <h3>üì• BIO-KOMPOST INPUT</h3>
                <textarea id="ki-input-text" readonly placeholder="Text wird automatisch aus Layer 2 √ºbertragen..."></textarea>
                <p class="readonly-hint">‚ö†Ô∏è Text kann nur durch Bio-Kompostierung erzeugt werden</p>
                
                <div class="ki-params">
                    <div class="param-row">
                        <label>ü§ñ Modus:</label>
                        <select id="ki-mode">
                            <option value="compress">üóúÔ∏è Verdichten (50%)</option>
                            <option value="expand">üìà Erweitern (150%)</option>
                            <option value="alienate">üîÄ Verfremden</option>
                            <option value="dream">üåÄ Halluzinieren</option>
                        </select>
                    </div>
                    
                    <div class="param-row">
                        <label>üåÄ Chaos: <span id="chaos-val">50%</span></label>
                        <input type="range" id="chaos-level" min="0" max="100" value="50">
                    </div>
                    
                    <button class="btn-ferment" id="btn-ki-transform">
                        ‚ö° FERMENTIEREN
                    </button>
                </div>
            </div>
            
            <!-- OUTPUT BOX (erscheint nach Transformation) -->
            <div id="ki-output-box" class="ki-box floating-blue-strong hidden">
                <h3>üß¨ FERMENTIERT</h3>
                <div id="ki-output-text" class="output-text"></div>
                
                <div class="ki-actions">
                    <button class="btn-humus-blue hidden" id="btn-ki-humus">
                        ‚Üíüíô HUMUS SPEICHERN
                    </button>
                    <span id="ki-humus-status"></span>
                </div>
                <p class="click-hint">üí° Click auf diese Box ‚Üí Layer 4 (Humus)</p>
            </div>
        </div>
    </div>

    <!-- LAYER 4: HUMUS-CHAOS -->
    <div id="layer4" class="layer">
        <div class="compost-background-black">
            <img src="images/kompost_b.jpg" alt="Kompost" style="opacity: 0.02; filter: blur(5px);">
        </div>
        
        <!-- Navigation (nur zur√ºck, kein weiter) -->
        <button class="btn-nav btn-back" onclick="switchLayer(3)">‚Üê</button>
        
        <div class="humus-fullscreen">
            <!-- Canvas f√ºr Humus-Visualisierung (Vollbild) -->
            <canvas id="humus-canvas"></canvas>
            
            <!-- Export-Button schwebend -->
            <button class="btn-export-float" id="btn-export-humus">
                üì• EXPORTIEREN
            </button>
        </div>
    </div>

    <!-- JavaScript -->
    <script src="js/humus.js"></script>
    <script src="js/humus-v2.js"></script>
    <script src="js/layers.js"></script>
    <script src="js/book.js"></script>
    <script src="js/generator.js"></script>
    <script src="js/ki-humus.js"></script>
    <script src="js/swipe.js"></script>
    <script src="js/bandcamp.js"></script>
</body>
</html>
